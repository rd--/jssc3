<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<link rel="icon" type="image/png" href="png/os.512.png" />
		<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/aaaakshat/cm-web-fonts@latest/fonts.css" />
		<link rel="stylesheet" type="text/css" media="all" href="css/smallhours.css" />
		<script src="lib/commonmark.js/dist/commonmark.js"></script>
		<script src="lib/osc.js/dist/osc-browser.js"></script>
		<script type="module">
import * as sc from './dist/jssc3.js'
import * as sl from './lib/spl/dist/sl.js'
import * as sh from './js/smallhours.js'
globalThis.sc = sc;
globalThis.sl = sl;
globalThis.sh = sh;
window.addEventListener('popstate', function(event) {
	console.log(`text: ${event.state.text}`);
	sh.insertText(null, event.state.text);
});
sl.addLoadUrlMethods();
window.onload = function () {
	sc.sc3_wasm_init(sc.setter_for_inner_html_of('statusText'));
	sc.sc3_mouse_init(globalScSynth);
	sc.connect_button_to_input('programInputFileSelect', 'programInputFile');
	sl.assignGlobals();
	sl.loadUrlArrayInSequence('lib/spl/sl', ['kernel.sl', 'std.sl', 'sc.sl', 'ui.sl']);
	document.getElementById('documentText').addEventListener('keydown', sh.keyBindings);
	document.getElementById('programText').addEventListener('keydown', sh.keyBindings);
	sh.initProgramMenu();
	sh.initOracle();
	sh.loadUrlParam();
};
		</script>
	</head>
	<body>
		<h1>Small Hours</h1>
		<div class="menuContainer">
			<button id="beginButton" title="Begin (b)" accesskey="b" onclick="globalScSynth.boot()">Begin</button>
			<span id="statusText">…</span>
			<input type="file" id="programInputFile" accept=".sl" onchange="sh.loadInputFile()" style="display:none">
			<button id="programInputFileSelect" title="Load (l)" accesskey="l">⇧</button>
			<button id="helpButton" title="Help (?)" accesskey="?" onclick="sh.loadInstructions()">?</button>
			<button id="oracleButton" title="Oracle (r)" accesskey="r" onclick="sh.loadOracle()">易</button>
			<select id="programMenu" title="Program (p)" accesskey="p"><option>--Program Menu--</option></select>
			<button title="Fullscreen (x)" accesskey="x" onclick="sc.fullscreen()">⇱</button>
		</div>
		<div class="textContainer">
			<div class="documentContainer">
				<div id="documentText" contenteditable="true" spellcheck="false">
				</div>
			</div>
			<div class="programContainer">
				<pre><code id="programText" contenteditable="true" spellcheck="false"></code></pre>
			</div>
		</div>
		<script async src="lib/scsynth-wasm-builds/ext/scsynth.js"></script>
	</body>
</html>
