<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="icon" type="image/png" href="png/os.512.png" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/aaaakshat/cm-web-fonts@latest/fonts.css" />
    <link rel="stylesheet" type="text/css" media="all" href="css/sc3.css" />
    <script src="lib/osc.js/dist/osc-browser.js"></script>
    <script type="module">
import * as sc from './js/jssc3.js'
import * as sl from './lib/spl/js/sl.js'
globalThis.sc = sc;
globalThis.sl = sl;
globalThis.playUgen = (ugenGraph) => sc.playUgen(globalScsynth, ugenGraph);
globalThis.splEval = () => eval(sl.rewriteString(sc.get_selected_text_or_contents_of('programText')));
globalThis.splLoad = () => sc.read_text_file_from_file_input_and_set_element_text('programInputFile', 0, 'programText');
sl.addLoadUrlMethods();
window.onload = function () {
    sc.sc3_wasm_init(sc.setStatusDisplay);
	sc.sc3_mouse_init(globalScsynth);
	sc.connect_button_to_input('programInputFileSelect', 'programInputFile');
    sl.assignGlobals();
    sl.loadUrlArrayInSequence('lib/spl/sl', ['prelude.sl', 'sc.sl']);
};
    </script>
  </head>
  <body>
    <h1>Simple Programming Language</h1>
    <div class="menuContainer">
      <button title="Boot" accesskey="b" onclick="globalScsynth.boot()">Begin</button>
      <span id="statusText">â€¦</span>
      <input type="file" id="programInputFile" accept=".stc" onchange="splLoad()" style="display:none">
      <button id="programInputFileSelect" title="Load (l)" accesskey="l">Load</button>
      <button title="Evaluate (/)" accesskey="/" onclick="splEval()">Eval</button>
      <button title="Play (,)" accesskey="," onclick="sc.playUgen(globalScsynth, splEval(), 0)">Play</button>
      <button title="Reset (.)" accesskey="." onclick="sc.resetScsynth(globalScsynth)">Reset</button>
      <button title="Clear Schedule(\)" accesskey="\" onclick="_clear(_system.get('clock'))">Clear</button>
      <button title="Print" onclick="sc.prettyPrintSyndefOf(splEval())">Text</button>
    </div>
	<div class="textContainer">
		<pre id="programText" contenteditable="true" spellcheck="false"></pre>
    </div>
    <script async src="lib/scsynth-wasm-builds/ext/scsynth.js"></script>
  </body>
</html>
